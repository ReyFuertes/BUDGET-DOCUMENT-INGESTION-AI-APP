<div class="dashboard">
  <div class="header">
    <h2>Your Receipts</h2>
    <p-button 
        label="Download Excel Report" 
        icon="pi pi-download" 
        (onClick)="download()" 
        [disabled]="receipts().length === 0" 
        severity="success">
    </p-button>
  </div>

  <div class="card">
    <p-table [value]="receipts()" [tableStyle]="{ 'min-width': '50rem' }" styleClass="p-datatable-striped">
      <ng-template pTemplate="header">
        <tr>
          <th>Date</th>
          <th>Merchant</th>
          <th>Items</th>
          <th>Total</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-r>
        <tr>
          <td>{{ r.storeDate | date:'shortDate' }}</td>
          <td>{{ r.merchantName }}</td>
          <td>
            <div *ngFor="let i of r.items" class="item-row">
              {{ i.description }} ({{ i.amount | currency }})
            </div>
          </td>
          <td class="font-bold">{{ r.totalAmount | currency }}</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
            <td colspan="4" class="text-center p-4">No receipts processed yet.</td>
        </tr>
    </ng-template>
    </p-table>
  </div>
</div>